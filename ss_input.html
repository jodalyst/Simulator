<!DOCTYPE html>
<html>
<head>
  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="./static/time_series.js" ></script>
  <link rel="stylesheet" href="./static/gui.css">
  <script src="./static/numeric-1.2.6.min.js" type="text/javascript"></script>
<!--  <script src="/static/lti.js"></script>-->
</head>
<body>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>


<center>
\(\textbf{E}\): <input type="text" size="50" value="" name="E_input" id="E_input" class="matrix" maxlength="100" /><br></br>
\(\textbf{A}\): <input type="text" size="50" value="" name="A_input" id="A_input" class="matrix" maxlength="100" /><br></br>
\(\textbf{B}\): <input type="text" size="50" value="" name="B_input" id="B_input" class="matrix" maxlength="100" /><br></br>
\(\textbf{C}\): <input type="text" size="50" value="" name="C_input" id="C_input" class="matrix" maxlength="100" /><br></br>
\(\textbf{D}\): <input type="text" size="50" value="" name="D_input" id="D_input" class="matrix" maxlength="100" /><br></br>
</center>

<!-- <script type="text/javascript">
function do_update(){
        var a = $('#A_input').val();
        var b = $('#B_input').val();
        var c = $('#C_input').val();
        var d = $('#D_input').val();
        var e = $('#E_input').val();
    }
do_update(null);
$("#A_input").keyup(do_update);
$("#B_input").keyup(do_update);
$("#C_input").keyup(do_update);
$("#D_input").keyup(do_update);
$("#E_input").keyup(do_update);
</script> -->


<span class="eq_display_area" style="display:block;">
	<center>
		<p id="displayed_eq1"></p>
		<p id="displayed_eq2"></p>
	</center>
</span>

<script>
$(document).ready(function(){
var states_ahead = "\\begin{bmatrix} x_1\\\\x_2\\\\x_3\\end{bmatrix} \\frac{d}{dt}";
var states = "\\begin{bmatrix}x_1\\\\x_2\\\\x_3\\end{bmatrix}";


var inputs = '\\begin{bmatrix} u \\end{bmatrix}';
var outputs = '\\begin{bmatrix} y \\end{bmatrix}';
var matrices = {A:'[[0,0],[0,0]]',
                B: '[[0,0],[0,0]]',
                C: '[[0,0],[0,0]]',
                D: '[[0,0],[0,0]]',
                E: '[[0,0],[0,0]]',}
var display_string1 = "";
var display_string2= "";
var display_string_A= "";
var display_string_B= "";
var display_string_C= "";
var display_string_D= "";
var display_string_E= "";

function stringIsEmpty(str) {
	return (!str || 0 === str.length);
}

var render_display_string =function(matrix) {
  var display_string = "";
  var vals = $("#"+matrix+"_input").val();
  if (! stringIsEmpty(vals)){
    vals = vals.replace(' ', '');
    var rows = [];
    var outer = false;
    var inner = false;
    var row = ''
    for (var x = 0; x < vals.length; x++){
      if (outer == false && vals[x] == '['){
        outer = true;
      }
      else if (outer == true && vals[x] == '['){
        inner = true;
      }
      else if (inner == true && vals[x] == ']'){
        inner = false;
        rows.push(row);
        row = '';
      }
      else if (inner ==true){
        row += vals[x];
      }
      else if (inner==false && outer==true && vals[x]==']'){
        outer = false;
        }
    }
    display_string += "\\begin{bmatrix}";
    for (var r=0; r<rows.length;r++){
      cols = rows[r].split(",");
      var len = cols.length;
      for (var i = 0; i<cols.length; i++){
        display_string +=cols[i];
        if (i < len-1){
          display_string +="&";
        }else if(r!=rows.length-1){
          display_string += "\\\\";
        }
      }
    }
    display_string += "\\end{bmatrix}";
  }

  if (matrix =="A"){
    display_string_A= display_string+states;
  }else if(matrix =="E"){
    display_string_E = display_string+states_ahead+"=";
  }else if(matrix =="B"){
    display_string_B = "+"+display_string+inputs;
  }else if(matrix =="C"){
    display_string_C= outputs+"="+display_string+states;
  }else if(matrix =="D"){
    if (display_string != ""){
      display_string_D= "+"+ display_string+inputs;
    }else{
      display_string_D= "";
    }
  }
  if (matrix =="A" || matrix=="E" || matrix == "B"){
    $("#displayed_eq1").html("<span class='cs_math_to_render'>"+display_string_E+display_string_A+display_string_B+"</span>");
    //MathJax.Hub.Queue(["Typeset",MathJax.Hub,"#displayed_eq1"]);
  }else{
    $("#displayed_eq2").html("<span class='cs_math_to_render'>"+display_string_C+display_string_D+"</span>");
    //MathJax.Hub.Queue(["Typeset",MathJax.Hub,"#displayed_eq2"]);
  }

};
$("#A").keyup(function(){
  render_display_string("A");
});
$("#B").keyup(function(){
  render_display_string("B");
});
$("#C").keyup(function(){
  render_display_string("C");
});
$("#D").keyup(function(){
  render_display_string("D");
});
$("#E").keyup(function(){
  render_display_string("E");
});
render_display_string("A");
render_display_string("B");
render_display_string("C");
render_display_string("D");
render_display_string("E");
});
</script>
</body>
